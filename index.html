<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GOAL GUIDE</title>
    <style>
        body { background: #0b0f14; color: #fff; font-family: 'Segoe UI', sans-serif; margin: 0; padding: 10px; }
        header { text-align: center; padding: 15px; font-size: 22px; font-weight: 800; color: #facc15; text-transform: uppercase; }
        
        .match-container { max-width: 600px; margin: 0 auto; }
        .league-title { background: #1b2230; padding: 8px 15px; font-size: 13px; font-weight: bold; color: #8b949e; border-radius: 5px 5px 0 0; border-bottom: 1px solid #2d3748; }
        
        .match-card { background: #151a21; margin-bottom: 10px; border-radius: 0 0 8px 8px; overflow: hidden; }
        .match-row { display: grid; grid-template-columns: 80px 1fr 60px 1fr; align-items: center; padding: 15px 10px; border-bottom: 1px solid #1f2937; }
        
        /* အချိန် Font ကို ကြီးပေးထားသည် */
        .match-time { font-size: 16px; font-weight: bold; color: #9aa4b2; text-align: center; line-height: 1.2; }
        .live-status { font-size: 12px; color: #ef4444; display: block; animation: blink 1.2s infinite; }
        
        .team { display: flex; flex-direction: column; align-items: center; gap: 8px; text-align: center; }
        .team img { width: 32px; height: 32px; object-box: contain; } /* Logo ထည့်ထားသည် */
        .team span { font-size: 13px; font-weight: 600; }
        
        .score-box { font-size: 20px; font-weight: 800; color: #facc15; text-align: center; }
        
        @keyframes blink { 0%, 100% {opacity:1} 50% {opacity:0.4} }
        .loading { text-align: center; padding: 40px; color: #8b949e; }
    </style>
</head>
<body>

<header>⚽ GOAL GUIDE</header>
<div class="match-container" id="match-list">
    <p class="loading">Loading matches...</p>
</div>

<script>
    const API_BASE = "https://goalguide-api-1.onrender.com";

    async function fetchMatches() {
        try {
            const res = await fetch(`${API_BASE}/api/today`);
            const data = await res.json();
            renderMatches(data);
        } catch (e) {
            console.error(e);
        }
    }

    function renderMatches(matches) {
        const list = document.getElementById("match-list");
        if (!matches || matches.length === 0) {
            list.innerHTML = "<p style='text-align:center'>No matches scheduled today.</p>";
            return;
        }

        let html = `<div class="league-title">SUPERLIGA (DENMARK)</div><div class="match-card">`;

        matches.forEach(m => {
            const home = m.participants.find(p => p.meta.location === 'home');
            const away = m.participants.find(p => p.meta.location === 'away');
            
            // မြန်မာစံတော်ချိန်သို့ ပြောင်းခြင်း (+6:30)
            const utcTime = new Date(m.starting_at);
            const mmTime = utcTime.toLocaleTimeString('en-GB', { 
                hour: '2-digit', 
                minute: '2-digit', 
                hour12: true 
            });

            // Live ဖြစ်နေလျှင် Status ပြရန်
            const isLive = m.state && ["INPLAY", "HT", "LIVE"].includes(m.state.state);
            const statusText = isLive ? `<span class="live-status">LIVE</span>` : "";

            // Score Logic
            const homeScore = m.scores.find(s => s.description === 'CURRENT' && s.score.participant_id === home.id)?.score.goals ?? 0;
            const awayScore = m.scores.find(s => s.description === 'CURRENT' && s.score.participant_id === away.id)?.score.goals ?? 0;
            const scoreDisplay = (m.state.state === "NS") ? "vs" : `${homeScore} - ${awayScore}`;

            html += `
                <div class="match-row">
                    <div class="match-time">
                        ${mmTime}
                        ${statusText}
                    </div>
                    <div class="team">
                        <img src="${home.image_path}" onerror="this.src='https://cdn-icons-png.flaticon.com/512/53/53283.png'">
                        <span>${home.name}</span>
                    </div>
                    <div class="score-box">${scoreDisplay}</div>
                    <div class="team">
                        <img src="${away.image_path}" onerror="this.src='https://cdn-icons-png.flaticon.com/512/53/53283.png'">
                        <span>${away.name}</span>
                    </div>
                </div>`;
        });

        html += `</div>`;
        list.innerHTML = html;
    }

    fetchMatches();
    // 1 မိနစ်တစ်ခါ အလိုအလျောက် Update လုပ်မည်
    setInterval(fetchMatches, 60000);
</script>
</body>
</html>
