<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GOAL GUIDE | Pro Scores</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        *{box-sizing:border-box;margin:0;padding:0}
        body{font-family:'Inter',sans-serif;background:#0b0f14;color:#fff;}
        header{padding:16px;background:#111827;display:flex;justify-content:center;position:sticky;top:0;z-index:100;border-bottom:1px solid #1f2937;}
        .logo{font-weight:800;color:#facc15;font-size:22px;}
        .date-bar{display:flex;justify-content:center;align-items:center;gap:12px;padding:20px 15px;}
        .date-bar button{background:#1f2937;border:none;color:#fff;width:35px;height:35px;border-radius:10px;cursor:pointer;}
        .date-bar input{background:#1f2937;border:none;color:#fff;padding:8px 12px;border-radius:8px;font-weight:700;font-family:inherit;}
        .tabs{display:flex;gap:10px;padding:0 15px 20px;justify-content:center;}
        .tab{background:#151a21;border:1px solid #30363d;padding:10px 25px;border-radius:999px;color:#9aa4b2;cursor:pointer;font-weight:600;}
        .tab.active{background:#facc15;color:#000;border-color:#facc15;}
        .league{margin:0 15px 15px;background:#151a21;border-radius:12px;border:1px solid #1f2937;overflow:hidden;}
        .league-header{padding:12px 15px;font-size:12px;font-weight:700;background:#1b2230;color:#8b949e;display:flex;align-items:center;gap:10px;}
        .league-header img{width:20px;height:20px;}
        .match{display:grid;grid-template-columns:70px 1fr 70px 1fr;align-items:center;padding:20px 15px;border-top:1px solid #1f2937;}
        .team{display:flex;flex-direction:column;align-items:center;gap:8px;text-align:center;}
        .team img{width:35px;height:35px;object-fit:contain;}
        .team span{font-size:13px;font-weight:600;}
        .score-box{font-size:20px;font-weight:800;text-align:center;color:#facc15;}
        .time-status{font-size:12px;color:#9aa4b2;font-weight:700;text-align:center;}
        .live-tag{color:#ef4444;animation:blink 1.2s infinite;}
        @keyframes blink { 0%, 100% {opacity:1} 50% {opacity:0.3} }
        .status-msg{text-align:center;padding:50px;color:#8b949e;}
    </style>
</head>
<body>

<header><div class="logo">⚽ GOAL GUIDE</div></header>

<div class="date-bar">
    <button onclick="changeDate(-1)">◀</button>
    <input type="date" id="matchDate" onchange="handleDateChange(this.value)">
    <button onclick="changeDate(1)">▶</button>
</div>

<div class="tabs">
    <button class="tab active" id="liveBtn" onclick="setTab('LIVE')">LIVE</button>
    <button class="tab" id="matchesBtn" onclick="setTab('MATCHES')">MATCHES</button>
</div>

<div id="matches"></div>

<script>
    const API_BASE = "https://goalguide-api-1.onrender.com"; 
    const matchesEl = document.getElementById("matches");
    const dateInput = document.getElementById("matchDate");
    
    let currentTab = "LIVE";
    let selectedDate = new Date().toISOString().split('T')[0];

    dateInput.value = selectedDate;

    function setTab(tab) {
        currentTab = tab;
        document.getElementById('liveBtn').classList.toggle('active', tab === 'LIVE');
        document.getElementById('matchesBtn').classList.toggle('active', tab === 'MATCHES');
        loadMatches();
    }

    function handleDateChange(date) {
        selectedDate = date;
        setTab('MATCHES');
    }

    function changeDate(n) {
        let d = new Date(selectedDate);
        d.setDate(d.getDate() + n);
        selectedDate = d.toISOString().split('T')[0];
        dateInput.value = selectedDate;
        setTab('MATCHES');
    }

    async function loadMatches() {
        matchesEl.innerHTML = "<p class='status-msg'>Loading...</p>";
        
        const url = (currentTab === "LIVE") 
            ? `${API_BASE}/api/live` 
            : `${API_BASE}/api/fixtures/date/${selectedDate}`;

        try {
            const res = await fetch(url);
            if (!res.ok) throw new Error('Offline');
            const data = await res.json();
            renderMatches(data);
        } catch (e) {
            matchesEl.innerHTML = "<p class='status-msg' style='color:#ef4444;'>Backend is starting up. Refresh in 1 min.</p>";
        }
    }

    function renderMatches(data) {
        if (!data || data.length === 0) {
            matchesEl.innerHTML = `<p class='status-msg'>No matches found.</p>`;
            return;
        }

        let html = "";
        data.forEach(m => {
            const status = m.fixture.status.short;
            const isLive = ["1H", "2H", "HT", "ET", "P"].includes(status);
            const score = (status === "NS") ? "vs" : `${m.goals.home ?? 0} - ${m.goals.away ?? 0}`;
            
            html += `
            <div class="league">
                <div class="league-header">
                    <img src="${m.league.logo}" onerror="this.style.display='none'"> 
                    ${m.league.name}
                </div>
                <div class="match">
                    <div class="time-status">
                        ${isLive ? `<span class="live-tag">● ${m.fixture.status.elapsed}'</span>` : status}
                    </div>
                    <div class="team">
                        <img src="${m.teams.home.logo}">
                        <span>${m.teams.home.name}</span>
                    </div>
                    <div class="score-box">${score}</div>
                    <div class="team">
                        <img src="${m.teams.away.logo}">
                        <span>${m.teams.away.name}</span>
                    </div>
                </div>
            </div>`;
        });
        matchesEl.innerHTML = html;
    }

    loadMatches();
    setInterval(() => { if(currentTab === "LIVE") loadMatches(); }, 60000);
</script>
</body>
</html>
